<!DOCTYPE html>
<html lang="zh-cmn-Hans" itemscope itemtype="http://schema.org/Article">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <!-- <title>webpack 配置 sass-loader | Eli&#39;s Blog</title> -->
  
  
  <!--link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css"-->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css">
  <link rel="stylesheet" href="/css/style.css">

  <!-- COMMON TAGS -->
  <title>webpack 配置 sass-loader | Eli&#39;s Blog</title>
  <!-- Search Engine -->
  <meta name="description" content="Eli 關於前端技術，寫作，分享的的部落格">
  <meta name="image" content="https://a2825818.github.io/images/head.png">
  <!-- Schema.org for Google -->
  <meta itemprop="name" content="webpack 配置 sass-loader | Eli&#39;s Blog">
  <meta itemprop="description" content="Eli 關於前端技術，寫作，分享的的部落格">
  <meta itemprop="image" content="https://a2825818.github.io/images/head.png">

  <!-- Open Graph general (Facebook, Pinterest & Google+) -->
  <!-- <meta name="og:title" content="webpack 配置 sass-loader | Eli&#39;s Blog">
  <meta name="og:description" content="Eli 關於前端技術，寫作，分享的的部落格">
  <meta name="og:image" content="https://a2825818.github.io/images/head.png">
  <meta name="og:url" content="https://a2825818.github.io/">
  <meta name="og:site_name" content="Eli 關於前端技術，寫作，分享的的部落格">
  <meta name="og:locale" content="en_TW">
  <meta name="fb:app_id" content="184314668878905">
  <meta name="og:type" content="website"> -->

  <link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
  <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#33363b">
  <link rel="manifest" href="/favicons/site.webmanifest">


  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="https://a2825818.github.io/">
  <meta name="twitter:title" content="webpack 配置 sass-loader | Eli&#39;s Blog">
  <meta name="twitter:description" content="Eli 關於前端技術，寫作，分享的的部落格">
  <meta name="twitter:creator" content="@Eli">
  <!-- Twitter summary card with large image must be at least 280x150px -->
  <meta name="twitter:image:src" content="https://a2825818.github.io/images/head.png">

  <!-- Open Graph data -->
  <meta property="og:title" content="webpack 配置 sass-loader | Eli&#39;s Blog" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://a2825818.github.io/" />
  <meta property="og:image" content="https://a2825818.github.io/images/head.png" />
  <meta property="og:description" content="Eli 關於前端技術，寫作，分享的的部落格" />
  <meta property="og:site_name" content="Eli 部落格" />
  <meta property="article:published_time" content="2018-04-17T05:59:00+01:00" />
  <meta property="article:modified_time" content="2018-05-01T19:08:47+01:00" />
  <meta property="article:section" content="Article Section" />
  <meta property="article:tag" content="Article Tag" />
  <meta property="fb:admins" content="184314668878905" />

  
  <link rel ="apple-touch-icon" href="touch-icon-iphone.png">
  <link rel ="apple-touch-icon" sizes ="152x152" href ="touch-icon-ipad.png">
  <link rel ="apple-touch-icon" sizes ="180x180" href ="touch-icon-iphone-retina.png">
  <link rel ="apple-touch-icon" sizes ="167x167" href ="touch-icon-ipad-retina.png">

  <meta name="msapplication-TileColor" content="#0E2B5E"/>

  <!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117497943-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-117497943-1');
  </script>



</head>

<body>
<script src="/js/pager/dist/fb-analytics.js"></script>


<div class="Shell">
    <aside class='SideBar'>
    <section class='avatar' style="background-image: url(/assets/header.png)">
        <div class='av-pic' style="background-image: url(/images/head.png)">
        </div>
    </section>
    <section class='menu'>
        <div class='blog-name'>Eli&#39;s Blog</div>
        
            <div class='motto'>How to make the world better？</div>
        
        <ul>
          
            <a href="/" class="Btn">
              <li>Home</li>
            </a>  
          
            <a href="/archives/" class="Btn">
              <li>Archive</li>
            </a>  
          
            <a href="/about/" class="Btn">
              <li>About</li>
            </a>  
          
        </ul>
    </section>
    <section class="media">
        
    </section>
</aside>

    <div class="container">
        <div data-pager-shell>
            <div>
  <article class='ContentView'>
    <header class='PageTitle'>
        <h1>webpack 配置 sass-loader</h1>
    </header>

    <section>
      <p>前端常常遇到許多繁瑣的問題，譬如SCSS寫好要編譯、CSS各瀏覽器要加上前綴、壓縮打包…等等，如果經常需要工程師自己手動處理，除了提高出錯率，也會降低開發效率。因此自動化工具變成前端越來越不可少的工具之一。</p>
<p>今天要來推薦最近很火的webpack，·由於webpack配置相當靈活，所以網路上很可能會查到許多不同的配置方式，以下示範的是如何配置 SCSS 編譯，以及會使用的相關插件。</p>
<h2 id="介紹webpack"><a href="#介紹webpack" class="headerlink" title="介紹webpack"></a>介紹webpack</h2><p>前端自動打包工具。官方提供不同的插件和 Loader，可靈活裝載和配置，解決不同的問題。</p>
<h2 id="基本安裝和配置"><a href="#基本安裝和配置" class="headerlink" title="基本安裝和配置"></a>基本安裝和配置</h2><h3 id="環境需求"><a href="#環境需求" class="headerlink" title="環境需求"></a>環境需求</h3><blockquote>
<p>nodejs</p>
</blockquote>
<h3 id="安裝webpack"><a href="#安裝webpack" class="headerlink" title="安裝webpack"></a>安裝webpack</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev webpack＠3</span><br></pre></td></tr></table></figure>
<p>PS:因 webpack 4 套件相容有所更動，我未能將錯誤都排除，所以本範例使用版本是webpack 3 和相容的配置方式。</p>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>文件樹狀圖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">webpack-dome</span><br><span class="line">  ├ dist</span><br><span class="line">  ├ node_modules</span><br><span class="line">  ├ scss</span><br><span class="line">  | ├ modules</span><br><span class="line">  | ├ pages</span><br><span class="line">  | └ partials</span><br><span class="line">  ├ index.html</span><br><span class="line">  ├ main.js</span><br><span class="line">  ├ package-lock.json</span><br><span class="line">  ├ package.json</span><br><span class="line">  └ webpack.config.js</span><br></pre></td></tr></table></figure></p>
<h2 id="webpack-config-js-文件配置"><a href="#webpack-config-js-文件配置" class="headerlink" title="webpack.config.js 文件配置"></a>webpack.config.js 文件配置</h2><h3 id="匯入-webpack-和相關插件"><a href="#匯入-webpack-和相關插件" class="headerlink" title="匯入 webpack 和相關插件"></a>匯入 webpack 和相關插件</h3><p>有時候在不同情境下，可能會將 CSS 按不同頁分開，就得使用這個插件，如果你沒有拆分 CSS 的需求，就不需要安裝。</p>
<blockquote>
<p>ExtractTextWebpackPlugin 能將 CSS 分離出來成單獨的檔案</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const webpack = require(&apos;webpack&apos;)</span><br><span class="line">const ExtractTextPlugin = require(&apos;extract-text-webpack-plugin&apos;)</span><br></pre></td></tr></table></figure>
<p>安裝 extract-text-webpack-plugin</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i extract-text-webpack-plugin --save-dev</span><br></pre></td></tr></table></figure>
<h3 id="文件入口"><a href="#文件入口" class="headerlink" title="文件入口"></a>文件入口</h3><p>entry 是設定文件的來源，可以多檔案打包成一支，也可以按需求打包不同的檔案，後面是文件來源，前面是生成文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line">    &apos;main&apos;: &apos;./main.js&apos;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>在 main.js 裡可以 import 各模塊，或者是寫上任何的JS。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// main.js</span><br><span class="line">import &apos;./scss/pages/index.scss&apos;</span><br></pre></td></tr></table></figure>
<h3 id="文件出口"><a href="#文件出口" class="headerlink" title="文件出口"></a>文件出口</h3><p>output 是指定出口，通常都是在根的某個資料夾，一般取名為“dist”，他也有其他參數可設定</p>
<blockquote>
<p>譬如<br>path 指定一個資料夾，作為目標路徑<br>filename 指的就是生成的檔案要怎麼命名，而 [name] 就是按原檔名。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, &apos;dist&apos;),</span><br><span class="line">    filename: &apos;[name].js&apos;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h3 id="外掛和套件"><a href="#外掛和套件" class="headerlink" title="外掛和套件"></a>外掛和套件</h3><p>plugins 是一些插件設置的地方，</p>
<blockquote>
<p>譬如<br>new webpack.optimize.OccurrenceOrderPlugin()  // 排序輸出，<br>new ExtractTextPlugin() // 將CSS獨立分割</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">  new webpack.optimize.OccurrenceOrderPlugin(),</span><br><span class="line">  new ExtractTextPlugin(&#123;</span><br><span class="line">      filename: &quot;[name].css&quot;,</span><br><span class="line">      disable: process.env.NODE_ENV === &quot;development&quot;,</span><br><span class="line">      allChunks: true</span><br><span class="line">  &#125;)</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<h3 id="sass-loader"><a href="#sass-loader" class="headerlink" title="sass-loader"></a>sass-loader</h3><p>module 是設定加載 Loader 處理器的地方，而每個不同的 Loader 目的都是為了將不同的東西轉成可以被 Javascript 加載的模塊，譬如圖片、CSS 或其他語言，然後再進行處理、打包等。</p>
<p>sass-Loader 就是針對 SCSS 的處理器，當然也包含編譯成 CSS。</p>
<p>我們先將相關的 Loader 都裝起來。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i sass-loader scc-loader style-loader postcss-loader autoprefixer --save-dev</span><br></pre></td></tr></table></figure>
<blockquote>
<p>sass-loader        處理 SCSS<br>scc-loader        處理 CSS<br>style-loader        處理 <code>&lt;style&gt;</code> 裡的 CSS<br>postcss-loader    處理 CSS 其他雜事<br>autoprefixer        自動加 CSS 前綴</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            test: /\.scss|.sass$/,</span><br><span class="line">            use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">                 fallback: &quot;style-loader&quot;,</span><br><span class="line">                 use:[&#123;</span><br><span class="line">                   loader:&apos;css-loader&apos;,</span><br><span class="line">                   options:&#123;</span><br><span class="line">                     url:false,</span><br><span class="line">                     minimize: false,</span><br><span class="line">                     sourceMap: true,</span><br><span class="line">                     importLoaders: 1</span><br><span class="line">                   &#125;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   loader:&apos;postcss-loader&apos;,</span><br><span class="line">                   options: &#123;</span><br><span class="line">                     ident: &apos;postcss&apos;,</span><br><span class="line">                     plugins: (loader) =&gt; [</span><br><span class="line">                       require(&apos;autoprefixer&apos;)(&#123;</span><br><span class="line">                         &quot;browsers&quot;: [&quot;last 5 versions&quot;]</span><br><span class="line">                       &#125;),</span><br><span class="line">                     ]</span><br><span class="line">                   &#125;</span><br><span class="line">                 &#125;,</span><br><span class="line">                 &#123;</span><br><span class="line">                   loader:&apos;sass-loader&apos;</span><br><span class="line">                 &#125;]</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>loader 的執行是由後到前的，而 postcss-loader 又規定要在 css-loader 之前處理完成。自然就變成了這樣的順序。<br>這裡使用了一個 autoprefixer ，設定主要瀏覽器的最後五個版本，作為前綴範圍，舒服阿 ～ (茶)</p>
<blockquote>
<p>曾在這裡遇過一個問題，就是在 SCSS 檔裡寫相對路徑，會造成編譯失敗的問題，<br>好像是 loader 對 url 解析不能以”.“作為開頭，<br>不過這樣配置之後，這個問題已解決。</p>
</blockquote>
<p>最後接手的 style-loader 是將 CSS 直接寫進<code>&lt;style&gt;</code>中，但有配置將 CSS 分割成獨立的檔案的話，它就會變成CSS檔，不會寫到JS裡，這裡可以看需求調整。</p>
<h3 id="執行-webpack"><a href="#執行-webpack" class="headerlink" title="執行 webpack"></a>執行 webpack</h3><p>這時候在 package.json 裡 scrpits 新增一行指令，即可在指令行快速使用 webpack</p>
<blockquote>
<p>webpack –config webpack.config.js 這段指定 webpack.config.js 文件，作為配置文件。<br>-w 就是持續監聽文件，如果一產生變化儲存，則自動進行編譯。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;start&quot;: &quot;webpack --config webpack.config.js -w&quot;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>執行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure>
<h3 id="範例"><a href="#範例" class="headerlink" title="範例"></a>範例</h3><p>以下是我的範例包，有興趣的可以抓下來試看看。</p>
<p><a href="https://github.com/a2825818/webpack3-sass-loader-demo" target="_blank" rel="noopener">範例</a></p>


      

    </section>
    
      <section class='ArticleMeta'>
          <div>
            發布於&nbsp;
            <time datetime="2018-05-01T01:22:19.000Z" itemprop="datePublished">
              2018-05-01
            </time>
          </div>
          
            <div>
              tags: 
  <li class="meta-text">
  { <a href="/tags/webpack/">webpack</a> }
  </li>

  <li class="meta-text">
  { <a href="/tags/sass-loader/">sass-loader</a> }
  </li>

  <li class="meta-text">
  { <a href="/tags/自動打包/">自動打包</a> }
  </li>

  <li class="meta-text">
  { <a href="/tags/自動化工具/">自動化工具</a> }
  </li>


            </div>
          
      </section>
    

    <div id="disqus_thread"></div>
    <script>

    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://https-a2825818-github-io.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>


    
</article>

  
</div>

            <footer>
    <div>© 2016 - Eli </div>
    <div>
    Powered by Hexo
    </div>
    <div>
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    全站總瀏覽 <span id="busuanzi_value_site_pv"></span> 人&nbsp&nbsp&nbsp 
    本頁瀏覽 <span id="busuanzi_value_page_pv"></span> 次
    </div>
</footer>

        </div>
    </div>
</div>
<script src="/js/pager/dist/singlepager.js"></script>
<script>
var sp = new Pager('data-pager-shell')

</script>
<script id="dsq-count-scr" src="//https-a2825818-github-io.disqus.com/count.js" async></script>
</body>
</html>